# Анализатор времени пребывания сотрудников на рабочем месте

## Запуск

### Без докера

Используется python 3.9.
Управление зависимостями происходит через [poetry](https://python-poetry.org/). Установить их можно с помощью `poetry install`.
По умолчанию переменные окружения `input` и `output` не установлены, поэтому необходимо либо использовать `-in` и `-out`, либо задать переменные окружения.

Запуск: `python -m attendance_analyzer -in resources/test.xml -out -`

### С докером
#### Сборка образа

Используется команда `docker build -t attendance_analyzer .` в корне.

#### Запуск контейнера

`docker run --rm --name attendance_analyzer -v $(pwd)/resources/:/app/resources/ attendance_analyzer`

Предполагается, что в директории, из которой происходит запуск, лежит папка `resources`. Из нее будет браться файл для анализа (по умолчанию `test.xml`), поскольку только она монтируется внутрь контейнера, и в нее же будет класться результат работы программы (по умолчанию `test-output.csv`).
Пути входного и выходного файлов могут мыть переопределены, но так же в рамках `resources`. 
Так же для вывода поддерживается `-` в качестве стандартного потока вывода. 

#### Список доступных опций запуска

- `-in, --input` — путь к входному файлу, по умолчанию `resources/test.xml`
- `-out, --output` — путь к выходному файлу, по умолчанию `resources/test-output.xml`
- `--group-employees` — флаг для группировки по работникам
- `--filter-person` — фильтрация по `full_name` работника в тэге `<person>`, возможно использовать несколько раз
- `--start-date` — фильтрация по начальной дате, используется паттерн `%d-%m-%Y`
- `--end-date` — фильтрация по конечной дате до 23:59:59, используется паттерн `%d-%m-%Y`
- `--regex` — используемый паттерн для парсинга даты и времение в тэгах `<start>` и `<end>`, по умолчанию `%d-%m-%Y %H:%M:%S` 